(()=>{"use strict";const t=function(t,e){let o=0;return{length:t,type:e,numHits:o,shipIsSunk:!1,hitLocations:[],hit:function(){o+=1},isSunk:function(){return t===o}}},e=function(){let e=[],o=[],a=new Array(10);for(let t=0;t<a.length;t++)a[t]=new Array(10);for(let t=0;t<a.length;t++)for(let e=0;e<a.length;e++)a[t][e]={isShip:!1,isAttacked:!1};const r={carrier:5,battleship:4,cruiser:3,submarine:3,destroyer:2};function n(){const t=Object.keys(r)[o.length];let e=prompt(`Enter orientation for ${t}`);return"horizontal"!==e&&"vertical"!==e?(alert("Invalid orientation. Please enter horizontal or vertical."),n()):e}function i(t,e,o,r){if("horizontal"===r){if(t+o>a.length)return!1;for(let r=t;r<t+o;r++)if(a[r][e].isShip)return!1}else if("vertical"===r){if(e+o>a.length)return!1;for(let r=e;r<e+o;r++)if(a[t][r].isShip)return!1}return!0}return{missedAttacks:e,ships:o,board:a,placeShips:function(e){const r={carrier:5,battleship:4,cruiser:3,submarine:3,destroyer:2};for(const[s,c]of Object.entries(r)){let r,l,d;if(e)do{r=Math.floor(10*Math.random()),l=Math.floor(10*Math.random()),d=Math.random()<.5?"horizontal":"vertical"}while(!i(r,l,c,d));else for(r=parseInt(prompt(`Enter x coordinate for ${s}`)),l=parseInt(prompt(`Enter y coordinate for ${s}`)),d=n();!i(r,l,c,d);)alert("Invalid placement. Please enter new coordinates."),r=parseInt(prompt(`Enter x coordinate for ${s}`)),l=parseInt(prompt(`Enter y coordinate for ${s}`)),d=n();const u=t(c,s);if(o.push(u),"horizontal"===d)for(let t=r;t<r+c;t++)u.hitLocations.push({x:t,y:l}),a[t][l].isShip=!0,a[t][l].ship=u;else if("vertical"===d)for(let t=l;t<l+c;t++)u.hitLocations.push({x:r,y:t}),a[r][t].isShip=!0,a[r][t].ship=u}},receiveAttack:function(t,o){a[t][o].isAttacked=!0,a[t][o].isShip?a[t][o].ship.hit():e.push({x:t,y:o})},allSunk:function(){return o.every((t=>t.isSunk()))}}},o=document.getElementById("human-board"),a=document.getElementById("computer-board"),r=document.querySelector(".start-game"),n=document.querySelector("#message"),i={name:"Human",gameboard:e(),attack:function(t,e,o){t.receiveAttack(e,o)}},s={name:"Computer",gameboard:e(),attack:function(t){let e=Math.floor(10*Math.random()),o=Math.floor(10*Math.random());t.receiveAttack(e,o)}};r.addEventListener("click",(()=>{i.gameboard.placeShips(!1),s.gameboard.placeShips(!0),i.gameboard.board.forEach(((t,e)=>{t.forEach(((t,a)=>{const r=document.createElement("div");r.classList.add("square"),t.isShip&&r.classList.add("ship"),r.dataset.x=e,r.dataset.y=a,r.addEventListener("click",(t=>{console.log("clicked "+t.target.dataset.x,t.target.dataset.y)})),o.appendChild(r)}))})),s.gameboard.board.forEach(((t,e)=>{t.forEach(((t,o)=>{const r=document.createElement("div");r.classList.add("square"),t.isShip&&r.classList.add("ship"),r.dataset.x=e,r.dataset.y=o,r.addEventListener("click",(()=>{console.log("Computer was clicked at "+r.dataset.x,r.dataset.y)})),a.appendChild(r)}))}))})),console.log(i);let c=i,l=!0;function d(t,e){let o;o=c===i?s.gameboard:i.gameboard;const a=o.board[t][e];a.isShip&&(a.ship.numHits++,function(){let t;t=c===i?s.gameboard:i.gameboard,t.allSunk()&&(l=!1,c===i?(c===i&&(n.textContent="You win!"),console.log("You win!")):(c===s&&(n.textContent="You lose!"),console.log("You lose!")))}(),c===s)&&d(Math.floor(10*Math.random()),Math.floor(10*Math.random()))}const u=(()=>{document.getElementById("human-board");const t=document.getElementById("computer-board");return document.getElementById("message"),t.addEventListener("click",(function(t){const e=t.target.dataset.x,o=t.target.dataset.y,a=s.gameboard.board[e][o];if(!a.isAttacked){if(a.isAttacked=!0,a.isShip){const e=a.ship;if(e.isSunk())return void console.log(`The ${e.type} is already sunk!`);e.hit(),e.isSunk()?console.log(`You sunk the ${e.type}!`):console.log(`You hit the ${e.type}!`),t.target.classList.add("hit")}else console.log("You missed!"),t.target.classList.add("miss");d(Number(e),Number(o))}})),{renderBoards:function(){}}})();u.renderBoards()})();